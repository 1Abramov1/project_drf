# Django REST Framework: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫—É—Ä—Å–∞–º–∏ –∏ —É—Ä–æ–∫–∞–º–∏

API –¥–ª—è –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω–æ–π –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã —Å —Å–∏—Å—Ç–µ–º–æ–π –∫—É—Ä—Å–æ–≤, —É—Ä–æ–∫–æ–≤, –ø–ª–∞—Ç–µ–∂–µ–π –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–∞–≤–∞–º–∏ –¥–æ—Å—Ç—É–ø–∞.

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

```bash
# –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞
git clone <repo-url>
cd project_drf
python -m venv venv
venv\Scripts\activate      # Windows
source venv/bin/activate   # Mac/Linux

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
pip install -r requirements.txt

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
cp .env.example .env
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ .env —Ñ–∞–π–ª, –¥–æ–±–∞–≤—å—Ç–µ Stripe –∫–ª—é—á–∏

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
python manage.py migrate
python manage.py createsuperuser
python manage.py runserver

üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

¬∑ materials/ ‚Äî –ö—É—Ä—Å—ã –∏ —É—Ä–æ–∫–∏ (API, —Ç–µ—Å—Ç—ã, –ø–∞–≥–∏–Ω–∞—Ü–∏—è, Stripe –æ–ø–ª–∞—Ç–∞)
¬∑ users/ ‚Äî –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, –ø–ª–∞—Ç–µ–∂–∏, –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
¬∑ myproject/ ‚Äî –ù–∞—Å—Ç—Ä–æ–π–∫–∏ Django
¬∑ api/ ‚Äî –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ API endpoints

‚úÖ –ö–ª—é—á–µ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

¬∑ üîê JWT-–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —Å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º —Ç–æ–∫–µ–Ω–æ–≤
¬∑ üë• –ö–∞—Å—Ç–æ–º–Ω–∞—è –º–æ–¥–µ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (email –≤–º–µ—Å—Ç–æ username)
¬∑ üõ° –°–∏—Å—Ç–µ–º–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ (–º–æ–¥–µ—Ä–∞—Ç–æ—Ä—ã, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã)
¬∑ üí≥ Stripe –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –¥–ª—è –æ–Ω–ª–∞–π–Ω-–ø–ª–∞—Ç–µ–∂–µ–π
¬∑ üí∞ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞–º–∏ —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π –∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–æ–π
¬∑ üìÑ –ü–∞–≥–∏–Ω–∞—Ü–∏—è –¥–ª—è —Å–ø–∏—Å–∫–æ–≤ –∫—É—Ä—Å–æ–≤ –∏ —É—Ä–æ–∫–æ–≤
¬∑ ‚úÖ –¢–µ—Å—Ç–æ–≤–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ (–∑–∞–ø—É—Å–∫: coverage run manage.py test materials.tests)

üí≥ Stripe –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

–ü—Ä–æ–µ–∫—Ç –≤–∫–ª—é—á–∞–µ—Ç –ø–æ–ª–Ω—É—é –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —Å Stripe –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø–ª–∞—Ç–µ–∂–µ–π:

–ù–∞—Å—Ç—Ä–æ–π–∫–∞ Stripe

1. –°–æ–∑–¥–∞–π—Ç–µ –∞–∫–∫–∞—É–Ω—Ç –Ω–∞ stripe.com
2. –ü–æ–ª—É—á–∏—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–µ –∫–ª—é—á–∏ –∏–∑ Stripe Dashboard
3. –î–æ–±–∞–≤—å—Ç–µ –≤ .env —Ñ–∞–π–ª:
STRIPE_SECRET_KEY=sk_test_–≤–∞—à_—Å–µ–∫—Ä–µ—Ç–Ω—ã–π_–∫–ª—é—á
STRIPE_PUBLISHABLE_KEY=pk_test_–≤–∞—à_–ø—É–±–ª–∏—á–Ω—ã–π_–∫–ª—é—á

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
# –ü—Ä–∏–º–µ—Ä —Å–æ–∑–¥–∞–Ω–∏—è –ø–ª–∞—Ç–µ–∂–Ω–æ–π —Å–µ—Å—Å–∏–∏ —á–µ—Ä–µ–∑ API
import requests

# 1. –ü–æ–ª—É—á–∏—Ç—å JWT —Ç–æ–∫–µ–Ω
token_resp = requests.post("http://localhost:8000/api/users/token/", 
                          json={"email": "user@example.com", "password": "password"})
token = token_resp.json()["access"]

# 2. –°–æ–∑–¥–∞—Ç—å Stripe Checkout —Å–µ—Å—Å–∏—é
headers = {"Authorization": f"Bearer {token}"}
checkout_resp = requests.post(
    "http://localhost:8000/api/materials/courses/8/checkout/",
    headers=headers,
    json={}
)

# 3. –ü–æ–ª—É—á–∏—Ç—å —Å—Å—ã–ª–∫—É –¥–ª—è –æ–ø–ª–∞—Ç—ã
checkout_url = checkout_resp.json()["checkout_url"]
print(f"–°—Å—ã–ª–∫–∞ –¥–ª—è –æ–ø–ª–∞—Ç—ã: {checkout_url}")

üîå –û—Å–Ω–æ–≤–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã

–ú–µ—Ç–æ–¥ –≠–Ω–¥–ø–æ–∏–Ω—Ç –û–ø–∏—Å–∞–Ω–∏–µ –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
POST /api/users/token/ –ü–æ–ª—É—á–µ–Ω–∏–µ JWT-—Ç–æ–∫–µ–Ω–∞ ‚ùå
POST /api/users/token/refresh/ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ JWT-—Ç–æ–∫–µ–Ω–∞ ‚ùå
GET /api/materials/courses/ –°–ø–∏—Å–æ–∫ –∫—É—Ä—Å–æ–≤ ‚úÖ
POST /api/materials/courses/{id}/checkout/ –°–æ–∑–¥–∞–Ω–∏–µ Stripe —Å–µ—Å—Å–∏–∏ –¥–ª—è –æ–ø–ª–∞—Ç—ã –∫—É—Ä—Å–∞ ‚úÖ
POST /api/materials/lessons/ –°–æ–∑–¥–∞–Ω–∏–µ —É—Ä–æ–∫–∞ ‚úÖ
GET /api/materials/courses/{id}/lessons/ –£—Ä–æ–∫–∏ –∫—É—Ä—Å–∞ ‚úÖ

üõ† –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

¬∑ Django 4.2+ & Django REST Framework
¬∑ JWT –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è (SimpleJWT)
¬∑ Stripe API –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø–ª–∞—Ç–µ–∂–µ–π
¬∑ django-filter –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö
¬∑ SQLite (—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞) / PostgreSQL (–ø—Ä–æ–¥–∞–∫—à–µ–Ω)
¬∑ drf-yasg –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ API

üì¶ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
Django==4.2.0
djangorestframework==3.14.0
djangorestframework-simplejwt==5.3.0
django-filter==23.3
stripe==8.0.0
python-dotenv==1.0.0
drf-yasg==1.21.7
django-extensions==3.2.3

üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
# –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤
python manage.py test

# –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ —Å –ø–æ–∫—Ä—ã—Ç–∏–µ–º
coverage run manage.py test
coverage report
coverage html  # –¥–ª—è HTML –æ—Ç—á–µ—Ç–∞

# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ Stripe –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
python test_stripe_checkout.py

üìã –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö

–ö—É—Ä—Å (Course)

¬∑ name - –ù–∞–∑–≤–∞–Ω–∏–µ –∫—É—Ä—Å–∞
¬∑ description - –û–ø–∏—Å–∞–Ω–∏–µ –∫—É—Ä—Å–∞
¬∑ price - –¶–µ–Ω–∞ –∫—É—Ä—Å–∞
¬∑ stripe_price_id - ID —Ü–µ–Ω—ã –≤ Stripe
¬∑ owner - –í–ª–∞–¥–µ–ª–µ—Ü –∫—É—Ä—Å–∞

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å (CustomUser)

¬∑ email - Email (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –≤—Ö–æ–¥–∞)
¬∑ phone - –¢–µ–ª–µ—Ñ–æ–Ω
¬∑ city - –ì–æ—Ä–æ–¥
¬∑ avatar - –ê–≤–∞—Ç–∞—Ä

---

–ü—Ä–æ–µ–∫—Ç –≤ —Ä–∞–º–∫–∞—Ö –æ–±—É—á–µ–Ω–∏—è Django REST Framework

ü§ù –í–∫–ª–∞–¥ –≤ –ø—Ä–æ–µ–∫—Ç

1. –§–æ—Ä–∫–Ω–∏—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
2. –°–æ–∑–¥–∞–π—Ç–µ feature –≤–µ—Ç–∫—É (git checkout -b feature/AmazingFeature)
3. –ó–∞–∫–æ–º–º–∏—Ç—å—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è (git commit -m 'Add some AmazingFeature')
4. –ó–∞–ø—É—à—å—Ç–µ –≤–µ—Ç–∫—É (git push origin feature/AmazingFeature)
5. –û—Ç–∫—Ä–æ–π—Ç–µ Pull Request

üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ—Ç—Å—è –ø–æ–¥ –ª–∏—Ü–µ–Ω–∑–∏–µ–π MIT.

üë®‚Äçüíª –ê–≤—Ç–æ—Ä

–ê–ª–µ–∫—Å–∞–Ω–¥—Ä –ê–±—Ä–∞–º–æ–≤

üôè –ë–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç–∏

¬∑ –ö–æ–º–∞–Ω–¥–∞ Django –∑–∞ –æ—Ç–ª–∏—á–Ω—ã–π —Ñ—Ä–µ–π–º–≤–æ—Ä–∫
¬∑ –°–æ–æ–±—â–µ—Å—Ç–≤–æ Django REST Framework
¬∑ Stripe –∑–∞ —É–¥–æ–±–Ω—ã–π –ø–ª–∞—Ç–µ–∂–Ω—ã–π API
¬∑ –í—Å–µ –∫–æ–Ω—Ç—Ä–∏–±—å—é—Ç–æ—Ä—ã –ø—Ä–æ–µ–∫—Ç–∞

---

‚≠êÔ∏è –ù–µ –∑–∞–±—É–¥—å—Ç–µ –ø–æ—Å—Ç–∞–≤–∏—Ç—å –∑–≤–µ–∑–¥—É, –µ—Å–ª–∏ –ø—Ä–æ–µ–∫—Ç –±—ã–ª –ø–æ–ª–µ–∑–µ–Ω!
